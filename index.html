<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGIS - Cabinda Centro</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }

        #map {
            width: 100%;
            height: 100vh;
        }

        .control-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 250px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .control-panel h1 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .control-panel h2 {
            font-size: 14px;
            margin-top: 15px;
            margin-bottom: 10px;
            color: #34495e;
            font-weight: 600;
        }

        .basemap-selector {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .basemap-button {
            padding: 10px;
            border: 2px solid #ddd;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 13px;
        }

        .basemap-button:hover {
            background: #e9ecef;
            border-color: #3498db;
        }

        .basemap-button.active {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }

        .layer-control {
            display: flex;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
        }

        .layer-control input[type="checkbox"] {
            margin-right: 10px;
            cursor: pointer;
        }

        .layer-control label {
            cursor: pointer;
            font-size: 13px;
            color: #2c3e50;
        }

        .color-indicator {
            width: 15px;
            height: 15px;
            border-radius: 3px;
            margin-right: 8px;
            display: inline-block;
        }

        .info-box {
            background: #fff;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin-top: 15px;
            font-size: 12px;
            color: #555;
        }

        @media (max-width: 768px) {
            .control-panel {
                min-width: 200px;
                padding: 10px;
            }
        }

        .legend {
            background: white;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.1);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="control-panel">
        <h1>üó∫Ô∏è WebGIS Cabinda</h1>
        
        <h2>Mapas de Fundo</h2>
        <div class="basemap-selector">
            <div class="basemap-button active" data-basemap="osm">
                üó∫Ô∏è OpenStreetMap
            </div>
            <div class="basemap-button" data-basemap="cartodb">
                üé® CartoDB Positron
            </div>
            <div class="basemap-button" data-basemap="dark">
                üåô CartoDB Dark Matter
            </div>
        </div>

        <h2>Camadas</h2>
        <div class="layer-control">
            <input type="checkbox" id="cabinda-centro" checked>
            <span class="color-indicator" style="background: #3498db;"></span>
            <label for="cabinda-centro">Cabinda Centro</label>
        </div>
        <div class="layer-control">
            <input type="checkbox" id="pocos-oleo" checked>
            <span class="color-indicator" style="background: #e74c3c;"></span>
            <label for="pocos-oleo">Po√ßos de √ìleo</label>
        </div>
        <div class="layer-control">
            <input type="checkbox" id="pocos-abandonados" checked>
            <span class="color-indicator" style="background: #f39c12;"></span>
            <label for="pocos-abandonados">Po√ßos Temporariamente Abandonados</label>
        </div>
        <div class="layer-control">
            <input type="checkbox" id="regioes-mudancas" checked>
            <span class="color-indicator" style="background: #27ae60;"></span>
            <label for="regioes-mudancas">Regi√µes de Altas Mudan√ßas</label>
        </div>

        <div class="info-box">
            üí° Clique nos elementos do mapa para mais informa√ß√µes
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Initialize map centered on Cabinda, Angola
        const map = L.map('map', {
            center: [-5.32, 12.27],
            zoom: 11,
            zoomControl: false
        });

        // Add zoom control to bottom right
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);

        // Define basemaps
        const basemaps = {
            osm: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 19
            }),
            cartodb: L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: '¬© OpenStreetMap contributors ¬© CARTO',
                maxZoom: 19
            }),
            dark: L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '¬© OpenStreetMap contributors ¬© CARTO',
                maxZoom: 19
            })
        };

        // Add default basemap
        let currentBasemap = basemaps.osm.addTo(map);

        // Load GeoJSON layers
        const layers = {};
        
        // Cabinda Centro
        fetch('cabinda_centro.geojson')
            .then(response => response.json())
            .then(data => {
                layers.cabinda = L.geoJSON(data, {
                    style: {
                        fillColor: '#3498db',
                        fillOpacity: 0.3,
                        color: '#2980b9',
                        weight: 2
                    }
                }).addTo(map);
                
                const bounds = layers.cabinda.getBounds();
                map.fitBounds(bounds);
            })
            .catch(err => console.error('Error loading Cabinda Centro:', err));

        // Po√ßos de √ìleo
        fetch('pocos_oleo.geojson')
            .then(response => response.json())
            .then(data => {
                layers.oleo = L.geoJSON(data, {
                    pointToLayer: function(feature, latlng) {
                        return L.circleMarker(latlng, {
                            radius: 6,
                            fillColor: '#e74c3c',
                            color: '#c0392b',
                            weight: 2,
                            opacity: 1,
                            fillOpacity: 0.8
                        });
                    },
                    onEachFeature: function(feature, layer) {
                        if (feature.properties) {
                            const props = feature.properties;
                            const popup = `
                                <b>Nome:</b> ${props.WELL_NAME || props.SHORT_NAME || 'N/A'}<br>
                                <b>Operador:</b> ${props.OPERATOR || 'N/A'}<br>
                                <b>Status:</b> ${props.CURRENT_ST || 'N/A'}<br>
                                <b>Campo:</b> ${props.FIELD || 'N/A'}<br>
                                <b>Data Spud:</b> ${props.SPUD_DATE || 'N/A'}
                            `;
                            layer.bindPopup(popup);
                        }
                    }
                }).addTo(map);
            })
            .catch(err => console.error('Error loading Po√ßos de √ìleo:', err));

        // Po√ßos Temporariamente Abandonados
        fetch('pocos_temporariamente_abandonados.geojson')
            .then(response => response.json())
            .then(data => {
                layers.abandonados = L.geoJSON(data, {
                    pointToLayer: function(feature, latlng) {
                        return L.circleMarker(latlng, {
                            radius: 5,
                            fillColor: '#f39c12',
                            color: '#d68910',
                            weight: 2,
                            opacity: 1,
                            fillOpacity: 0.8
                        });
                    },
                    onEachFeature: function(feature, layer) {
                        if (feature.properties) {
                            const props = feature.properties;
                            const popup = `
                                <b>Nome:</b> ${props.WELL_NAME || props.SHORT_NAME || 'N/A'}<br>
                                <b>Operador:</b> ${props.OPERATOR || 'N/A'}<br>
                                <b>Status:</b> ${props.CURRENT_ST || 'N/A'}<br>
                                <b>Campo:</b> ${props.FIELD || 'N/A'}<br>
                                <b>Data Spud:</b> ${props.SPUD_DATE || 'N/A'}
                            `;
                            layer.bindPopup(popup);
                        }
                    }
                }).addTo(map);
            })
            .catch(err => console.error('Error loading Po√ßos Abandonados:', err));

        // Regi√µes de Altas Mudan√ßas
        fetch('regioes_altas_mudancas.geojson')
            .then(response => response.json())
            .then(data => {
                layers.mudancas = L.geoJSON(data, {
                    style: function(feature) {
                        const color = feature.properties.Nome === 'Area A' ? '#27ae60' : 
                                     feature.properties.Nome === 'Area B' ? '#e67e22' : 
                                     feature.properties.Nome === 'Area C' ? '#9b59b6' : '#34495e';
                        return {
                            fillColor: color,
                            fillOpacity: 0.4,
                            color: '#2c3e50',
                            weight: 2
                        };
                    },
                    onEachFeature: function(feature, layer) {
                        if (feature.properties) {
                            const props = feature.properties;
                            const popup = `
                                <b>Regi√£o:</b> ${props.Nome || 'N/A'}<br>
                                <b>√Årea (km¬≤):</b> ${props.Area || 'N/A'}
                            `;
                            layer.bindPopup(popup);
                        }
                    }
                }).addTo(map);
            })
            .catch(err => console.error('Error loading Regi√µes de Mudan√ßas:', err));

        // Basemap switching
        document.querySelectorAll('.basemap-button').forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                document.querySelectorAll('.basemap-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Add active class to clicked button
                this.classList.add('active');
                
                // Get basemap type
                const basemapType = this.getAttribute('data-basemap');
                
                // Remove current basemap
                map.removeLayer(currentBasemap);
                
                // Add new basemap
                currentBasemap = basemaps[basemapType];
                currentBasemap.addTo(map);
            });
        });

        // Layer visibility control
        document.getElementById('cabinda-centro').addEventListener('change', function(e) {
            if (layers.cabinda) {
                if (e.target.checked) {
                    map.addLayer(layers.cabinda);
                } else {
                    map.removeLayer(layers.cabinda);
                }
            }
        });

        document.getElementById('pocos-oleo').addEventListener('change', function(e) {
            if (layers.oleo) {
                if (e.target.checked) {
                    map.addLayer(layers.oleo);
                } else {
                    map.removeLayer(layers.oleo);
                }
            }
        });

        document.getElementById('pocos-abandonados').addEventListener('change', function(e) {
            if (layers.abandonados) {
                if (e.target.checked) {
                    map.addLayer(layers.abandonados);
                } else {
                    map.removeLayer(layers.abandonados);
                }
            }
        });

        document.getElementById('regioes-mudancas').addEventListener('change', function(e) {
            if (layers.mudancas) {
                if (e.target.checked) {
                    map.addLayer(layers.mudancas);
                } else {
                    map.removeLayer(layers.mudancas);
                }
            }
        });

        // Add scale control
        L.control.scale({
            position: 'bottomleft',
            imperial: false
        }).addTo(map);
    </script>
</body>
</html>

